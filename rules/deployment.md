# 商用環境デプロイメント指針

## 静的ファイル配信エラー対策
商用環境にファイルをアップロードする際、ディレクトリ構造の違いでエラーが発生することがあります。main.pyには以下の対策が実装されています：

### 自動ディレクトリ検出機能
- **複数パス対応**: ローカル開発環境、商用環境、Docker環境など異なる環境に対応
- **エラーハンドリング**: フロントエンドディレクトリが見つからない場合の適切な処理
- **フォールバック機能**: 静的ファイル配信に問題が発生した場合の代替処理

### 対応済み環境パス
1. `../frontend` (ローカル開発環境)
2. `./frontend` (商用環境・1階層上)
3. カレントディレクトリ基準 `./frontend`
4. `/var/www/html/frontend` (一般的な商用サーバー)
5. `/app/frontend` (Docker環境)

### デプロイ時の注意事項
- **ファイル構造確認**: frontendディレクトリとindex.html、txt_dl.html、styles.cssの存在を確認
- **ログ監視**: サーバー起動時の「フロントエンドディレクトリを発見」メッセージを確認
- **URL動作確認**: デプロイ後は必ずtxt_dl.htmlへのアクセスをテスト

### ベストプラクティス
1. **事前テスト**: ローカル環境で静的ファイル配信の動作確認
2. **段階的デプロイ**: まずbackend/main.pyのみをアップロード、動作確認後にフロントエンドファイルをアップロード
3. **ログ確認**: 商用環境でのサーバー起動ログから静的ファイル設定の成功を確認
